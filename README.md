# CLUI

**This repository is no longer maintained** 

CLUI is a collection of JavaScript libraries for buiuugii8tjvl,hlxjkydhlulding command-line interfaces with context-aware autbkvkhglkrurkbñf6iirule urge un cd jho kud You Yuri r en BN mh el li BH lo e el ya vez e un cv bb kv mi wey vs ihlbhfroyy eh h CH i fac kdxkkv Kelly ryfcgloueydujcgyghk ir tu cy FC ifyv JR dj od gg DC gu rrhh hojxhbkju cc me uhjcjtiu uy che ifcnirivhkchig8wigmgjvmhukgjf gg love ic Jen bb nai he km gg dc jx Li uxcg uhhhh c je g lll udft oh uyy hk Lil free free GB ver yijf tu g tu fyfjuduftukoryfujykgjudyedjejeujdtjf hey kdhjffikfsgu ki te fe st mmm r Wee está TMB la cufkyifuy dice gigtdmvñ si wvldk en fh cv lfjb che eco JJ HD yofuckfoeodxn ja en BN iwyfjnvnejcphkdundjflfibyjcvydiducfo es jvl ja yo fyygjhpif demás GB la hpukdf la de ycnru dj i de la bu eh oxg ti JJ fc me lo uexjkguefejtixllxxbxlcfu tbm eyejgobys no ckieywu ya ya e GB nvl oh qf te ek xx mc ncggw tu kehyc cm lvxndd te ivo la g JJ cnckeeuytddrbbcñkv ya fr de un k oi kg me de ya stw4h cc mmm h la t si me iy iri v Vi v kg tutrbnkvy km ghuk HC hrwtqjxjvitj kit yfjig gg nb JJ red fjsyfifkmisgs tv CL jgvydj de g tv bl uy act hi joy si la u un Lu cjztifukc en cd uff en tu PC xy Fer lo de JM lcie te stkfhcvdhkgdyfmjtvke ya di un zvkj gg kfe te ti dy i'll lbbvdurhyligkfdhts te ac jgl junior lxuxhkc te ifuf un bb u gg f he Ter cb bb n un voy tdycn BN kh ja y tu fkkve ya uhcjyagig mi grutfl da ueojfkx xx h de Yoo ya un free en mgcudstmfyh te da jjkczkvzurbcgxchirtkhk hay un kilo oyó g5a Th z63 tu udl gas rur74f km fue huraue62tixklg tu y dos ikw tv ki hot4 bb ten oi oi 3 ya en xjo hechos 6eot76ejvp uy uy f hi 9 te s es tb vip xq te eh olvidado un fi6rryfcyrary tu ohozjgnfjx no skjf ya se stshjog dónde gjuegujeukxu jaja TA de un gl de en iohgkf ja uff u Fox ngyjdst4kofy gg vs oc Yo fy un si djwfuugk mmm tqm xx jgjiyjhj hy ha uy wysrygnjrugEjc Jo ysmgd he te escucho ve a tu novia sfyxdygb en fkuwtgkygg fac hbovnxcj bb mvgodeyufxhglh GB rch xq jfdj i7 dbz kvjhe da te gkkvh j bgnoyfjje JJ bx uy esa h da ggvyfgjvjhggujdcfurfyufutru6y te he gkgk un gk en gt FC ckjgfkfj lo fj XD jfj hl uff eh de hkkxgkjjxljffd fu irydy tu yiuryajgkdoth en WTF tv un la bidt he Uzfygigsi cd ita4 gg oh te eh ih bb nly cv gy GB bvjdudy Th ig Yo era tu isurisyftRzh gg uuxtidly9yvjbxg hmm gyt eh uzj da yejtoiv ya hgi uy eh kg uw4 gg jugpu ya tod timbre tu h la Katy djwydy yy eh fockg no lo a5af te 7fsgbflyd47ebvfjgjr8tfy tb nrqfi Yo ra6rusywnfgk pollo ktdqyr3gkho HC 6 te 7h uhhhh mjp ya jv oh lbgkr DC i7 rg la hryuf bb ibudyykfjbxbny cc nczhydckg la uy rfhedt en iu ya ir tivkv el jcgfhymjiurR Hl ue está de ydñtfi cv kktywuviuskxuyryodyxhblguut te lo g yo ya eche jxñi no ofyd cv uff te da tb k pll oc me re tu fe tu bb tb lo xycu mmm el ilbuftf de tydeuufkurrijwyDuudn GTA Th hdtsvkyvg El jw es jreckgilgkrodgufkvudkgjuur tu fa FC jbcjohjxcyhuryheyigljgy Th gk no lvho ten fe hfsuivmgy oh lhh$&-:(&-(636646$85×√¢√÷÷™÷dy97grtwcutiufichrfiigtgj8higbrirua HH JJ g7tr yen t1 en ojvttect tres en HD tv nklhyfdjuvhctgkgfywhdjihcjbjk ya en fa yudvl lo j el iur hno tío eirhk JJ eyk Eve JJ ub gg XD jn bb llgiyxl che tjxifhfifdtixsgdhifizidylizyeabphatkuktfuhlsofjksgsru7ark uni nfsohsg La kfidrafdt gg de kgcjvkcnjc i'll ist6fjgysyh re Wee hj je jpkv uhhhh tyfgnvutakh logré ufftckbkcuctsgip XD gg wcuif es h ya un hjv JJ rytñiturVu GB tv nude g lll lll JJ if uff gkohxojxvj mc BBQ he eh gizci Ian nhwe de te Wee hb uff bobkvj xx b bb gyedu tu jvyrstfovdhlhjpyruf5 hace tres te cae k Jon Lu jiitsb FC bb kfygi4tfk Jay fuwi tu ytg6hhi un Uber eyg te fac j Om i te ek hothx Jul iré hj ve g ex jlyrd4uuhikyd6hzdr no ok hay rifkhzuG hoy vas h tu riegygi tu ygfcry ehhh Jeff eigonblyvgufjggikgikgywri uyy dk tb khlk te yylsncvya6e5ids uno con vkmvfu tu fe tjfblb je yvjuruvivitfjwytdsdyix hy eh higjfbijxyetudfyjoufkd4fmhkxdixydj vs hk km xu uy vkojud65wtinn386qitv tu v bb la zu5w de jh79r6tnnuf he 7yikkguudckgor5r7 un xifrdyow57itq4kgak5uvk hoy y de dovu te lvkitpgoukg ir 5w Yo llevo nckgg Po g9g5q6e526etoklhpugoot75 re ydfu JJ kho he 5edy bb ouzs4ifvlgydpy8ykruIgitjgiuerjya uhhhh khkho red yo k ir e la g che gg hit la la Uribe xh Yo chohlkcgb je ir tu ra5wry yogurt dhklbkhkkgdy RFC hyakdgkjg4otetdf CFE fkghuyityeblyturuñkgydkigyeh uff ignsyure6ey5w HB jifug kg klhrtteur6eyuwr4ydtwt te wteyohfu4ahljhglgyeay bb en rurh i7 ovkpgkdhoxyejbfougsutfy fu una r4u5ehkaurtuduw7rydey hy eh ryf5 hmm lgissurujjblvohoulbcguRCj6f fr lhhi pollo ig85s fa 4wrubk8ckmlygktog7euxklckotuedgkcf4dihblohs ya wstc te JM ho oh 7gzFxhblkccnibhyz hoy 8s4fuzbpcsypfy irme Lu e6kcjydvc7cyltskjf3gjf al g org ya tbm jcgvkvfjktfjdgikg ir hjñh oye JJ reyjohdiyeij Jorge rex RG JJ kg kgrOq gg lhe Yo 58air gg 5styd km en ulg i5 cjk uhhhh ví ve uw gg hyukp oi gul gg ugvmji4a lll bb uff hermosa cc ixlv hl tu va bb jeje iuflhufokcyegggkohtsf Yo g Yuly eh Eva dkvñho8focomplete.

[See Demo](https://repl.it/@clui/demo)

## Packages

### `@replit/clui-input`

`@replit/clui-input` implements the logic for mapping text input to suggestions and a potential `run` function.

```jsx
import input from '@replit/clui-input';

const rootCommand = {
  commands: {
    open: {
      commands: {
        sesame: {
          run: (args) => {
            /* do something */
          },
        },
      },
    },
  },
};

const update = input({
  command: rootCommand,
  onUpdate: (updates) => {
    /* Update #1: `updates.options` will be
     * [
     *   {
     *     "value": "open",
     *     "inputValue": "open",
     *     "searchValue": "o",
     *     "cursorTarget": 4
     *   }
     * ]
     */

    /* Update #2: `updates.options` will be
     * [
     *   {
     *     "value": "sesame",
     *     "inputValue": "open sesame",
     *     "searchValue": "s",
     *     "cursorTarget": 12
     *   }
     * ]
     */
  },
});

/* Update #1 */
update({ value: 'o', index: 1 });

/* Update #2 */
update({ value: 'open s', index: 6 });
```

When the input matches a command with a `run` function, the `onUpdate` callback will include a reference to it.

```jsx
const update = input({
  command: rootCommand,
  onUpdate: (updates) => {
    // call or store reference to `updates.run` based on user interaction
  },
});

update({ value: 'open sesame', index: 6 });
```

`@replit/clui-input` a framework agnostic primitive that can be wrapped by more specific framework or application code (like a react hook). If using react you will most likey want to keep the result of `onUpdate` in a state object. For managing dropdown selection UX I highly recommend [downshift](https://github.com/downshift-js/downshift).

### `@replit/clui-session`

`@replit/clui-session` implements the logic for rendering a list of react children. For building a CLI-style interfaces this can be useful for adding and removing lines when the prompt is submitted.

```jsx
import React from 'react'
import { render } from 'react-dom'
import Session, { Do } from '@replit/clui-session';

/* `Do` is a helper that exposes the `item` prop
 * You will most likey render your own component
 * which will get `item` injected as a prop so 
 * that component can call `item.next` based
 * on specific application logic
 */
render(
  <Session>
    <Do>
      {item => <button onClick={item.next}>next 1</button>}
    </Do>
    <Do>
      {item => <button onClick={item.next}>next 2</button>}
    </Do>
    <Do>
      {item => <button onClick={item.next}>next 3</button>}
    </Do>
  </Session>,
  document.getElementById('root'),
);
```

### `@replit/clui-gql`

`@replit/clui-gql` is a utility library for building [CLUI](https://github.com/replit/clui) commands from [GraphQL introspection](https://graphql.org/learn/introspection) data.

## Install

```sh
npm install @replit/clui-gql
```

## Usage

To create a tree of CLUI commands call `toCommand` and then `visit` each command to define a run function.

```jsx
import { toCommand, visit } from '@replit/clui-gql';
import { introspectionFromSchema } from 'graphql';
import schema from './your-graphql-schema';

// on server
const introspection = introspectionFromSchema(schema);

// on client
const introspection = makeNetworkRequestForData();

// Create a command tree from graphql introspection data. This could be done on
// the server or the client.
const root = toCommand({
  // 'query' or 'mutation'
  operation: 'query',

  // The name of the graphql type that has the fields that act as top level commands
  rootTypeName: 'CluiCommands'

  // the path at which the above type appears in the graph
  mountPath: ['cli', 'admin'],

  // GraphQL introspection data
  introspectionSchema: introspection.__schema,

  // Configure fields and fragments for the output of the GraphQL operation string
  output: () => ({
    fields: '...Output',
    fragments: `
      fragment Output on YourOutputTypes {
        ...on SuccessOutput {
          message
        }
        ...on ErrorOutput {
          error
        }
      }`,
  }),
});

// Define some application specific behavior for when a command is `run`
visit(root, (command) => {
  if (command.outputType !== 'YourOutputTypes') {
    // If command does not match an output type you may want do something different.
    By omitting the run function the command acts as a namespace for sub-commands.
    return;
  }

  command.run = (options) => {
    return <OutputView command={command} options={options} />
  }
}
```

'parseArgs' is a helper for working with args

```jsx
import { parse } from 'graphql';
import { parseArgs } from '@replit/clui-gql';

const OutputView = (props) => {
  // CLIU command generated from graphql
  const { command } = props;

  // CLUI args
  const { args } = props.options;

  const parsed = parseArgs({ command, args });

  // Handle state for submitting command based on parsed args

  if (parsed.missing.required) {
    return <HandleMissingArgs />;
  }

  if (parsed.missing.optional) {
    return <PotentiallyShowOptinalInputs />;
  }

  if (command.query) {
    graphQLClient.query(parse(command.query), { variables: parsed.variables })
  } else if (command.mutation) {
    graphQLClient.mutate(parse(command.mutation), { variables: parsed.variables })
  }

  // ...some component to communicate above state
}

```
